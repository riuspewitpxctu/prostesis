//Los pines se pueden reubicar donde se necesiten, tomando, claro, ciertas consideraciones

#include <OneWire.h>
#include <DallasTemperature.h>
#include <Keypad.h>

const int pinRelay1 = 10; //pin del peltier+cooler
const int pinRelay2 = 10; //pin de la bomba alimentadora
const int pinRelay3 = 10; //pin de la bomba expendedora

//pines del display
const int pinA = 10;                     
const int pinB = 10;
const int pinC = 10;
const int pinD = 10;
const int pinE = 10;
const int pinF = 10;
const int pinG = 10;
const int dp = 10;
const int Digito1 = 10;
const int Digito2 = 10;
const int Digito3 = 10;
const int Digito4 = 10;

//pin de datos del sensor de temperatura
const int pinDS18B20 = 10;         

//pines del teclado
const int pinMatriz1 = 10;           
const int pinMatriz2 = 10;
const int pinMatriz3 = 10;
const int pinMatriz4 = 10;
const int pinMatriz5 = 10;
const int pinMatriz6 = 10;
const int pinMatriz7 = 10;
const int pinMatriz8 = 10; //?Atte

//Declarando el teclado matriz
byte pinFila[4]    = {pinMatriz1, pinMatriz2, pinMatriz3, pinMatriz4};
byte pinColumna[4] = {pinMatriz5, pinMatriz6, pinMatriz7, pinMatriz8}; //pinMatriz8 es el pin que está más cerca a las letras
char keys [4][4]   = {{'1','2','3','A'},{'4','5','6','B'},{'7','8','9','C'},{'*','0','#','D'}};

// Instancia a las clases OneWire y DallasTemperature
OneWire SensorTemperatura(pinDS18B30);
DallasTemperature sensor.DS18B20(&SensorTemperatura)

// Instancia a la clase Keypad
Keypad teclado = Keypad(makeKeymap(keys), pinFila, pinColumna, 4, 4);

int T = 5;
int i = 0;
float temperatura_actual = 0;     // Aquí se guardará la temperatura segundo a segundo

//ATENCION
//Necesitas 4 RESISTENCIAS DE 330ohm//tal vez solo esto
//Necesitas 4 transistores 2n2222
//Creo..

byte Digit[10][8] =
  {  { 1,1,1,1,1,1,0,0 },    // 0
     { 0,1,1,0,0,0,0,0 },    // 1
     { 1,1,0,1,1,0,1,0 },    // 2
     { 1,1,1,1,0,0,1,0 },    // 3
     { 0,0,1,0,0,1,1,0 },    // 4    
     { 1,0,1,1,0,1,1,0 },    // 5
     { 1,0,1,1,1,1,1,0 },    // 6
     { 1,1,1,0,0,0,0,0 },    // 7
     { 1,1,1,1,1,1,1,0 },    // 8
     { 1,1,1,0,0,1,1,0 }     // 9
   };
   
//datos para un setup iterado
int matriz_output[10] = { colocar aquí todos las 10 etiquetas }
int matriz_input[10] = { colocar aquí todos las 10 etiquetas }

void setup(){

    Serial.begin(9600);
    sensorDS18B20.begin();

    for (int i=0; i<11; i++)
       pinMode(i, OUTPUT);
    for (int i=0; i<11; i++)
       pinMode(i, INPUT);
 
}

void loop(){

    temperatura_actual = leer_temperatura()

}

// Esto devuelve la temperatura del [sensor etiquetado con 0]
float leer_temperatura(){ sensors.requestTemperatures();
                          float temperatura = sensors.getTempCByIndex(0);
                          return temperatura};
                          
void mostrar(int pos, int N)
{  digitalWrite(9 ,LOW);      // Apaga todos los digitos
   digitalWrite(10,LOW);
   digitalWrite(11,LOW);
   digitalWrite(12,LOW);      
  
    for (int i= 0 ; i<8 ; i++)
             digitalWrite(i+2 , Digit[N][i]) ;
  
   digitalWrite(pos + 9, HIGH); // Enciende el digito pos
   //delay(1);
}

void CalculaDigitos( int Num)
{
  int Digit0 = Num %10 ;
  int Digit1 = (Num % 100) / 10 ;
  int Digit2 = (Num % 1000) / 100 ;
  int Digit3 = Num / 1000 ;
  
  mostrar(3 , Digit3);
  mostrar(2 , Digit2);
  mostrar(1 , Digit1);
  mostrar(0 , Digit0);
}
